<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
</head>
<body>

    {% include "partials/navbar.html" %}

    
</body>
</html>{% load static tailwind_tags %} {% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIET PMU - Projects</title>
    {% tailwind_css %}
</head>
<body class="bg-gray-100 font-sans">
    <div class="flex h-screen">
        
        <div class="max-w-4xl mx-auto p-6">
            <!-- Step Navigation -->
            <div class="flex justify-between items-center mb-8">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600">1</div>
                        <span class="ml-2 text-gray-600">Program</span>
                    </div>
                    <span class="text-gray-400">></span>
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600">2</div>
                        <span class="ml-2 text-gray-600">KPI</span>
                    </div>
                    <span class="text-gray-400">></span>
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600">3</div>
                        <span class="ml-2 text-gray-600">Workshops</span>
                    </div>
                    <span class="text-gray-400">></span>
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600">4</div>
                        <span class="ml-2 text-gray-600">Review Meetings</span>
                    </div>
                    <span class="text-gray-400">></span>
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600">5</div>
                        <span class="ml-2 text-gray-600">Manpower</span>
                    </div>
                </div>
            </div>

            <!-- Form Steps -->
            <div id="form-step-1" class="step">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Program Details</h2>
                <div class="mb-4">
                    {% comment %} <label class="block text-gray-700 mb-2">Program Type</label>
                    <select id="program-type" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" required>
                        <option value="">Select Program Type</option>
                        <option value="PAC">PAC</option>
                        <option value="PAB">PAB</option>
                        <option value="Others">Others</option>
                    </select>
                    <span class="error-message text-red-500 text-sm hidden">Please select a program type</span> {% endcomment %}

                    <h2 class="text-xl font-semibold text-gray-800 mb-4">My Assigned Programs</h2>
            {% if programs_title %}
                <div class="space-y-4">
                    {% for program in programs %}
                        <div class="p-4 border rounded-lg bg-gray-50">
                            <p><strong>Program Type:</strong> {{ program_type }}</p>
                            <p><strong>Program Title:</strong> {{ program_title }}</p>
                            <p><strong>Budget:</strong> â‚¹{{ program_budget}}</p>
                            {% comment %} <p><strong>Created At:</strong> {{ program.created_at|date:"d M Y" }}</p> {% endcomment %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="text-gray-600">No programs assigned to you.</p>
            {% endif %}
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Program Title</label>
                    <input type="text" id="program-title" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" required>
                    <span class="error-message text-red-500 text-sm hidden">Please enter a program title</span>
                </div>
                <div class="mt-6 flex justify-end">
                    <button id="next-1" class="px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50" disabled>Next</button>
                </div>
            </div>

            <div id="form-step-2" class="step hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">KPI Details</h2>
                <p class="text-gray-600 mb-6">Enter KPI Information.</p>
                <div class="space-y-4">
                    <div>
                        <input type="text" id="kpi-name" placeholder="KPI Name" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter KPI name</span>
                    </div>
                    <div>
                        <input type="date" id="workshop-date" placeholder="Workshop Date" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please select date</span>
                    </div>
                    <div>
                        <input type="number" id="kpi-target" placeholder="Budget" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter KPI budget</span>
                    </div>
                </div>
                <div class="mt-6 flex justify-between">
                    <button id="prev-2" class="px-4 py-2 bg-gray-200 rounded-lg">Previous</button>
                    <button id="next-2" class="px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50" disabled>Next</button>
                </div>
            </div>

            <div id="form-step-3" class="step hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Workshop Details</h2>
                <p class="text-gray-600 mb-6">Enter Workshop Information.</p>
                <div class="space-y-4">
                    <div>
                        <input type="text" id="workshop-title" placeholder="Workshop Title" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter workshop title</span>
                    </div>
                    <div>
                        <input type="date" id="workshop-date" placeholder="Workshop Date" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please select workshop date</span>
                    </div>
                    <div>
                        <input type="number" id="kpi-target" placeholder="Budget" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter workshop budget</span>
                    </div>
                </div>
                <div class="mt-6 flex justify-between">
                    <button id="prev-3" class="px-4 py-2 bg-gray-200 rounded-lg">Previous</button>
                    <button id="next-3" class="px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50" disabled>Next</button>
                </div>
            </div>

            <div id="form-step-4" class="step hidden">
                <h2 validated="text-xl font-semibold text-gray-800 mb-4">Review Meeting Details</h2>
                <p class="text-gray-600 mb-6">Enter Review Meeting Information.</p>
                <div class="space-y-4">
                    <div>
                        <input type="text" id="meeting-title" placeholder="Meeting Title" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter meeting title</span>
                    </div>
                    <div>
                        <input type="date" id="meeting-date" placeholder="Meeting Date" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please select meeting date</span>
                    </div>
                     <div>
                        <input type="number" id="kpi-target" placeholder="Budget" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter meeting budget</span>
                    </div>
                </div>
                <div class="mt-6 flex justify-between">
                    <button id="prev-4" class="px-4 py-2 bg-gray-200 rounded-lg">Previous</button>
                    <button id="next-4" class="px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50" disabled>Next</button>
                </div>
            </div>


            <div id="form-step-4" class="step hidden">
                <h2 validated="text-xl font-semibold text-gray-800 mb-4">Manpower Details</h2>
                <p class="text-gray-600 mb-6">Enter Manpower Information.</p>
                <div class="space-y-4">
                    <div>
                        <input type="text" id="meeting-title" placeholder="number of people" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter title</span>
                    </div>
                    <div>
                        <input type="date" id="meeting-date" placeholder="Meeting Date" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please select date</span>
                    </div>
                     <div>
                        <input type="number" id="kpi-target" placeholder="Budget" class="w-full p-2 border rounded-lg" required>
                        <span class="error-message text-red-500 text-sm hidden">Please enter Manpower budget</span>
                    </div>
                </div>
                <div class="mt-6 flex justify-between">
                    <button id="prev-4" class="px-4 py-2 bg-gray-200 rounded-lg">Previous</button>
                    {% comment %} <button id="next-5" class="px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50" disabled>Next</button> {% endcomment %}
                    <button id="submit" class="px-4 py-2 bg-purple-600 text-white rounded-lg">Submit</button>
                </div>
            </div>
            </div>
        </div>

           <div id="form-step-4" class="step hidden">
  <h2 validated="text-xl font-semibold text-gray-800 mb-4">Manpower Details</h2>
  <p class="text-gray-600 mb-6">Enter Manpower Information.</p>
  <div class="space-y-4">
    <div>
      <input type="text" id="manpower-count" placeholder="Number of People" class="w-full p-2 border rounded-lg" required>
      <span class="error-message text-red-500 text-sm hidden">Please enter manpower count</span>

    </div>
    <div>
      <input type="date" id="manpower-date" placeholder="Manpower Date" class="w-full p-2 border rounded-lg" required>
      <span class="error-message text-red-500 text-sm hidden">Please select date</span>
    </div>
    <div>
      <input type="number" id="manpower-budget" placeholder="Budget" class="w-full p-2 border rounded-lg" required>
      <span class="error-message text-red-500 text-sm hidden">Please enter manpower budget</span>
    </div>
  </div>
  <div class="mt-6 flex justify-between">
    <button id="prev-3" class="px-4 py-2 bg-gray-200 rounded-lg">Previous</button>
    <button id="submit" class="px-4 py-2 bg-green-600 text-white rounded-lg">Submit</button>
  </div>
</div>

<!-- 2. After the step container, show program card dynamically -->
<div id="submitted-program" class="max-w-4xl mx-auto p-6 hidden">
  <div class="bg-white shadow-md rounded-lg p-4 mb-6">
    <h3 class="text-xl font-bold text-gray-800 mb-2" id="submitted-program-title"></h3>
    <div class="flex gap-4">
      <button id="view-program" class="px-4 py-2 bg-blue-500 text-white rounded">View Program</button>
      <button id="edit-program" class="px-4 py-2 bg-yellow-500 text-white rounded">Edit Program</button>
    </div>
  </div>
</div>

<!-- 3. Update JS to handle these features -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const steps = document.querySelectorAll('.step');
    const nextButtons = document.querySelectorAll('[id^="next-"]');
    const prevButtons = document.querySelectorAll('[id^="prev-"]');
    const submitButton = document.getElementById('submit');
    let currentStep = 1;
    const formData = {};

    function validateStep(step) {
      const inputs = steps[step - 1].querySelectorAll('input, select');
      let isValid = true;
      inputs.forEach(input => {
        const errorMessage = input.nextElementSibling;
        if (!input.value.trim() || (input.tagName === 'SELECT' && input.value === '')) {
          isValid = false;
          errorMessage.classList.remove('hidden');
          input.classList.add('border-red-500');
        } else {
          errorMessage.classList.add('hidden');
          input.classList.remove('border-red-500');
          formData[input.id] = input.value;
        }
      });
      const nextButton = document.getElementById(`next-${step}`);
      if (nextButton) nextButton.disabled = !isValid;
      return isValid;
    }

    steps.forEach(step => {
      const inputs = step.querySelectorAll('input, select');
      inputs.forEach(input => {
        input.addEventListener('input', () => validateStep(currentStep));
      });
    });

    nextButtons.forEach(button => {
      button.addEventListener('click', () => {
        if (validateStep(currentStep)) {
          steps[currentStep - 1].classList.add('hidden');
          currentStep++;
          steps[currentStep - 1].classList.remove('hidden');
          validateStep(currentStep);
        }
      });
    });

    prevButtons.forEach(button => {
      button.addEventListener('click', () => {
        steps[currentStep - 1].classList.add('hidden');
        currentStep--;
        steps[currentStep - 1].classList.remove('hidden');
        validateStep(currentStep);
      });
    });

    submitButton.addEventListener('click', () => {
      if (!validateStep(currentStep)) return;
      // Hide form and show summary card
      document.querySelector('.step').parentElement.classList.add('hidden');
      const card = document.getElementById('submitted-program');
      const title = document.getElementById('submitted-program-title');
      title.textContent = formData['program-title'];
      card.classList.remove('hidden');
    });

    document.getElementById('view-program').addEventListener('click', () => {
      alert(JSON.stringify(formData, null, 2));
    });

    document.getElementById('edit-program').addEventListener('click', () => {
      currentStep = 1;
      document.getElementById('submitted-program').classList.add('hidden');
      document.querySelector('.step').parentElement.classList.remove('hidden');
      steps.forEach((step, index) => {
        step.classList.add('hidden');
      });
      steps[0].classList.remove('hidden');
      validateStep(1);
    });

    validateStep(1);
  });
</script>
