{% extends "layout.html" %}

{% block title %}CIET PMU - View projects{% endblock %}
{% load static %}
{% load static tailwind_tags %}

{% block content %}
<div class="flex min-h-screen">
    {% include "partials/admin_sidebar.html" %}
  <div class="flex-1 overflow-y-auto px-6 py-8 bg-gray-50">
    <h1 class="text-3xl font-bold mb-6 text-center">Project Budget Overview</h1>

    <!-- Filter Form -->
    <form method="POST" action="#" class="bg-white rounded-lg shadow p-6 grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
      <input type="text" name="project_name" placeholder="Project Name" class="border rounded px-3 py-2" />

      <select name="coordinator" class="border rounded px-3 py-2">
        <option value="">Select Coordinator</option>
        {% for coord in coordinators %}
          <option value="{{ coord.id }}">{{ coord.username }}</option>
        {% endfor %}
      </select>

    <select name="year" class="border rounded px-3 py-2">
        <option value="">Select Year</option>
        {% for item in years %}
        <option value="{{ item.year }}">{{ item.year }}</option>
        {% endfor %}
    </select>


      <select name="quarter" class="border rounded px-3 py-2">
        <option value="">Quarter</option>
        <option value="Q1">Q1</option>
        <option value="Q2">Q2</option>
        <option value="Q3">Q3</option>
        <option value="Q4">Q4</option>
      </select>

      <select name="month" class="border rounded px-3 py-2">
        <option value="">Month</option>
        {% for m in months %}
          <option value="{{ m }}">{{ m }}</option>
        {% endfor %}
      </select>

      <select name="period" class="border rounded px-3 py-2">
        <option value="">Period</option>
        <option value="monthly">Monthly</option>
        <option value="half_yearly">Half Yearly</option>
        <option value="all">All Projects</option>
      </select>

      <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 cursor-pointer text-white font-semibold py-2 rounded">Apply Filters</button>

    </form>

    <!-- Budget Table -->
    {% if budgets %}
      <div class="overflow-x-auto bg-white rounded-lg shadow">
        <table class="min-w-full table-auto">
          <thead class="bg-gray-200 text-gray-700 text-sm">
            <tr>
              <th class="px-4 py-3 text-left">Project Name</th>
              <th class="px-4 py-3 text-left">Coordinator</th>
              <th class="px-4 py-3 text-left">Year</th>
              <th class="px-4 py-3 text-left">Quarter</th>
              <th class="px-4 py-3 text-left">Amount</th>
            </tr>
          </thead>
          <tbody class="text-sm">
            {% for budget in budgets %}
              <tr class="border-t hover:bg-gray-50">
                <td class="px-4 py-2">{{ budget.project_name }}</td>
                <td class="px-4 py-2">{{ budget.coordinator.username }}</td>
                <td class="px-4 py-2">{{ budget.year }}</td>
                <td class="px-4 py-2">{{ budget.quarter }}</td>
                <td class="px-4 py-2">â‚¹{{ budget.amount }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Export Buttons -->
      <div class="mt-4 flex gap-4">
        {% comment %} <a href="{% url 'export_excel' %}?{{ request.GET.urlencode }}" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Download Excel</a> {% endcomment %}
        <a href="#" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Download Excel</a>
        <a href="#" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">Download PDF</a>
        {% comment %} <a href="{% url 'export_pdf' %}?{{ request.GET.urlencode }}" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">Download PDF</a> {% endcomment %}
      </div>
    {% else %}
      <p class="text-center text-gray-600 mt-6">No results found for selected filters.</p>
    {% endif %}
  </div>

</div>
{% endblock %}
